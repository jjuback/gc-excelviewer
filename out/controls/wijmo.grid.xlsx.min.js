/*!
    *
    * Wijmo Library 5.20201.664
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,l){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,l){e.__proto__=l}||function(e,l){for(var t in l)l.hasOwnProperty(t)&&(e[t]=l[t])})(e,l)};return function(e,l){extendStatics(e,l);function __(){this.constructor=e}e.prototype=null===l?Object.create(l):(__.prototype=l.prototype,new __)}}();!function(e){!function(l){!function(l){l.softDetail=function softDetail(){return e._getModule("wijmo.grid.detail")};l.softMultiRow=function softMultiRow(){return e._getModule("wijmo.grid.multirow")};l.softTransGrid=function softTransGrid(){return e._getModule("wijmo.grid.transposed")}}(l.xlsx||(l.xlsx={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){var l;(function(l){"use strict";var t=function(){function FlexGridXlsxConverter(){}FlexGridXlsxConverter.save=function(l,t,r){var o=new e.xlsx.Workbook;this._saveFlexGridToWorkbook(o,l,t,!1,null);r&&o.save(r);return o};FlexGridXlsxConverter.saveAsync=function(l,t,r,o,n,s){var i=this,a=null!=r,u=new e.xlsx.Workbook;this.cancelAsync((function(){var d,c=[l.collectionView&&l.collectionView.collectionChanged,l.columns&&l.columns.collectionChanged,l.rows&&l.rows.collectionChanged,l.resizedColumn,l.resizedRow],removeHandlers=function(){return c.forEach((function(e){e&&e.removeHandler(restart)}))},restart=function(){clearTimeout(d);d=setTimeout((function(){removeHandlers();u=null;i.saveAsync(l,t,r,o,n,s)}),100)},finish=function(){clearTimeout(d);i._cs=null;removeHandlers()};i._cs=new e.xlsx._SyncPromise(null,finish);c.forEach((function(e){e&&e.addHandler(restart)}));i._saveFlexGridToWorkbook(u,l,t,!0,i._cs,(function(l){e.isFunction(s)&&s(a?Math.round(e.xlsx._map(l,0,100,0,50)):l)})).then((function(){if(r){u._externalCancellation=function(){return i._cs};u.saveAsync(r,(function(l){finish();e.isFunction(o)&&o(l)}),(function(l){finish();e.isFunction(n)&&n(l)}),(function(l){e.isFunction(s)&&s(Math.round(e.xlsx._map(l,0,100,51,100)))}))}else{finish();e.isFunction(s)&&s(100)}}),(function(e){finish();throw e}))}));return u};FlexGridXlsxConverter.cancelAsync=function(l){var t=this;if(this._cs){this._cs.cancel();setTimeout((function(){t._cs=null;e.isFunction(l)&&l()}),100)}else e.isFunction(l)&&l()};FlexGridXlsxConverter.load=function(l,t,r){var o=this;if(t instanceof Blob){var n=new FileReader;n.onload=function(){var t=e.xlsx.Workbook._base64EncArr(new Uint8Array(n.result)),s=new e.xlsx.Workbook;s.load(t);t=null;l.deferUpdate((function(){o._loadToFlexGrid(l,s,r);s=null}))};n.readAsArrayBuffer(t)}else if(t instanceof e.xlsx.Workbook)l.deferUpdate((function(){o._loadToFlexGrid(l,t,r);t=null}));else{if(t instanceof ArrayBuffer)t=e.xlsx.Workbook._base64EncArr(new Uint8Array(t));else if(!e.isString(t))throw"Invalid workbook.";var s=new e.xlsx.Workbook;s.load(t);t=null;l.deferUpdate((function(){o._loadToFlexGrid(l,s,r);s=null}))}};FlexGridXlsxConverter.loadAsync=function(l,t,r,o,n){var s=this;if(t instanceof Blob){var i=new FileReader;i.onload=function(){var t=e.xlsx.Workbook._base64EncArr(new Uint8Array(i.result)),a=new e.xlsx.Workbook;a.loadAsync(t,(function(e){t=null;a=null;l.deferUpdate((function(){s._loadToFlexGrid(l,e,r);o&&o(e);e=null}))}),n)};i.readAsArrayBuffer(t)}else if(t instanceof e.xlsx.Workbook)l.deferUpdate((function(){s._loadToFlexGrid(l,t,r);o&&o(t);t=null}));else{if(t instanceof ArrayBuffer)t=e.xlsx.Workbook._base64EncArr(new Uint8Array(t));else if(!e.isString(t))throw"Invalid workbook.";(new e.xlsx.Workbook).loadAsync(t,(function(e){t=null;l.deferUpdate((function(){s._loadToFlexGrid(l,e,r);o&&o(e);e=null}))}),n)}};FlexGridXlsxConverter._saveFlexGridToWorkbook=function(l,t,o,s,i,a){var u,d=this,c=new e.xlsx._SyncPromise(i),f=new e.xlsx.WorkSheet,x=!o||null==o.includeColumnHeaders||o.includeColumnHeaders,h=!(!o||null==o.includeRowHeaders)&&o.includeRowHeaders,p=r.Cache,g=o?o.includeColumns:null,m=o?o.formatItem:null,w=0,y=h?t.rowHeaders.columns.length:0,v=[];o&&(p=!1===e.asBoolean(o.includeCellStyles,!0)?r.None:!1===e.asBoolean(o.quickCellStyles,!0)?r.Regular:r.Cache);var _=p===r.Cache?new n(500):null;null==this.hasCssText&&(this.hasCssText="cssText"in document.body.style);var C,b=t.wj_sheetInfo;f.name=o?o.sheetName:"";f.visible=!o||!1!==o.sheetVisible;if(b&&b.tables&&b.tables.length>0)for(var k=0;k<b.tables.length;k++)f.tables.push(b.tables[k]);u=[];if(!b&&(p!==r.None||m)){(C=document.createElement("div")).style.visibility="hidden";C.setAttribute(e.grid.FlexGrid._WJS_MEASURE,"true");t.hostElement.appendChild(C)}(h?[t.rowHeaders,t.columnHeaders]:[t.columnHeaders]).forEach((function(l){for(var r=l.rows,o=l.columns,n=0,s=l.cellType===e.grid.CellType.ColumnHeader?y:0,i=0;i<r.length;i++)if(!(r[i].renderSize<=0)){u[n]||(u[n]=[]);for(var a=0,c=0;a<o.length;a++){var h=t._getBindingColumn(l,i,o[a]),p=d._getColumnSetting(h,a,o);if(p){u[n][s+a]=p;if(0===n){if(l.cellType===e.grid.CellType.ColumnHeader&&g&&!g(h))continue;var m=new e.xlsx.WorkbookColumn;m._deserialize(p);f._addWorkbookColumn(m,s+c++)}}}n++}l.cellType===e.grid.CellType.ColumnHeader&&(w=x?n:0)}));var S=[[t.topLeftCells,t.columnHeaders],[t.rowHeaders,t.cells],[t.rowHeaders,t.columnFooters]];x||S.shift();var T=S.map((function(e){return e[1].rows.length})).reduce((function(e,l){return e+l}));this._saveContentToWorksheet(i,s,Date.now(),0,{panels:S,panelIdx:0,globRowIdx:0,rowsOffset:0,totalRows:T},t,f,h,u,p,C,v,_,g,m,(function(e){a(Math.round(e/T*100))}),(function(){var n=new e.xlsx.WorkbookFrozenPane;n.rows=x?t.frozenRows+w:t.frozenRows;n.columns=h?t.frozenColumns+y:t.frozenColumns;f.frozenPane=n;l._addWorkSheet(f);if(!b&&(p!==r.None||m)){t.hostElement.removeChild(C);v.forEach((function(e){return e.forEach((function(e){e&&e.parentElement&&e.parentElement.removeChild(e)}))}))}_&&_.clear();l.activeWorksheet=o?o.activeWorksheet:null;c.resolve()}));return c};FlexGridXlsxConverter._saveContentToWorksheet=function(l,t,r,o,n,s,i,a,u,d,c,f,x,h,p,g,m){for(var w=this,y=d?20:200,_loop_1=function(_){if(l&&l.cancelled)return{value:void 0};if(t&&_-o>y&&Date.now()-r>100){setTimeout((function(){if(!l||!l.cancelled){g(_);w._saveContentToWorksheet(l,t,Date.now(),_,n,s,i,a,u,d,c,f,x,h,p,g,m)}}),0);return{value:void 0}}if(_-n.rowsOffset>=n.panels[n.panelIdx][1].rows.length){n.rowsOffset+=n.panels[n.panelIdx][1].rows.length;n.panelIdx++}var C=n.panels[n.panelIdx],b=C[0],k=C[1],S=_-n.rowsOffset,T=k.rows[S];if(k.cellType!==e.grid.CellType.Cell&&T.renderSize<=0||T instanceof e.grid._NewRowTemplate)return"continue";var F=0,R={},W=new e.xlsx.WorkbookRow,A=T instanceof e.grid.GroupRow,G=0;k.cellType===e.grid.CellType.Cell&&(A?G=T.level:s.rows.maxGroupLevel>-1&&(G=s.rows.maxGroupLevel+1));a&&(F=v._parseFlexGridRowToSheetRow(b,R,S,0,u,d,c,f,x,A,G,h,p));v._parseFlexGridRowToSheetRow(k,R,S,F,u,d,c,f,x,A,G,h,p);if(R.cells.length>0){W._deserialize(R);i._addWorkbookRow(W,n.globRowIdx)}n.globRowIdx++},v=this,_=o;_<n.totalRows;_++){var C=_loop_1(_);if("object"==typeof C)return C.value}e.isFunction(m)&&m()};FlexGridXlsxConverter._loadToFlexGrid=function(l,t,r){r=r||{};var o,n=null!=l.wj_sheetInfo,s={},i=[],a=[],u={};l.itemsSource=null;l.columns.clear();l.columnHeaders.rows.clear();l.rowHeaders.columns.clear();l.rows.clear();l.frozenColumns=0;l.frozenRows=0;var d=null==r.sheetIndex||isNaN(r.sheetIndex)?0:r.sheetIndex;if(d<0||d>=t.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=r.sheetName)for(var c=0;c<t.sheets.length;c++)if(r.sheetName===t.sheets[c].name){o=t.sheets[c];break}if(null!=(o=o||t.sheets[d]).rows){for(var f=this._getColumnCount(o.rows),x=this._getRowCount(o.rows,f),h=o.columns,p=0;p<f;p++){l.columns.push(new e.grid.Column);if(h[p]){isNaN(+h[p].width)||(l.columns[p].width=+h[p].width);h[p].visible||null==h[p].visible||(l.columns[p].visible=!!h[p].visible);h[p].style&&h[p].style.wordWrap&&(l.columns[p].wordWrap=h[p].style.wordWrap)}}var g,m=(null==r.includeColumnHeaders||r.includeColumnHeaders)&&o.rows.length>0,w=m?this._getColumnHeadersHeight(o):0,y=!1,v=[],_=o.frozenPane&&o.frozenPane.rows,C=o.frozenPane&&o.frozenPane.columns;_=e.isNumber(_)&&!isNaN(_)?_:null;C=e.isNumber(C)&&!isNaN(C)?C:null;for(var b=w;b<x;b++){var k=!1,S=null,T=o.rows[b];if(T)for(var F=b+1;F<o.rows.length;){var R=o.rows[F];if(R){(isNaN(T.groupLevel)&&!isNaN(R.groupLevel)||!isNaN(T.groupLevel)&&T.groupLevel<R.groupLevel)&&(k=!0);break}F++}if(k&&!o.summaryBelow){g&&(g.isCollapsed=y);(g=new e.grid.GroupRow).isReadOnly=!1;y=null!=T.collapsed&&T.collapsed;g.level=isNaN(T.groupLevel)?0:T.groupLevel;u[g.level]=y;this._checkParentCollapsed(u,g.level)&&g._setFlag(e.grid.RowColFlags.ParentCollapsed,!0);l.rows.push(g)}else{var W=new e.grid.Row;T&&this._checkParentCollapsed(u,T.groupLevel)&&W._setFlag(e.grid.RowColFlags.ParentCollapsed,!0);l.rows.push(W)}T&&T.height&&!isNaN(T.height)&&(l.rows[b-w].height=T.height);for(p=0;p<f;p++)if(T){var A=T.cells[p],G=A?A.formula:null;G&&"="!==G[0]&&(G="="+G);if(A&&A.textRuns&&A.textRuns.length>0){l.rows[b-w].isContentHtml=!0;l.setCellData(b-w,p,this._parseTextRunsToHTML(A.textRuns))}else l.setCellData(b-w,p,G&&n?G:this._getItemValue(A));k||this._setColumn(v,p,A);var D=b*f+p,N=A?A.style:null,E=e.xlsx.Workbook._parseExcelFormat(A),B=void 0;if(N){S=null==S?!!N.wordWrap:S&&!!N.wordWrap;if(N.hAlign)B=e.xlsx.Workbook._parseHAlignToString(e.asEnum(N.hAlign,e.xlsx.HAlign));else switch(this._getItemType(A)){case e.DataType.Number:B="right";break;case e.DataType.Boolean:B="center";break;default:B=E&&0===E.search(/[n,c,p]/i)?"right":"left"}s[D]={fontWeight:N.font&&N.font.bold?"bold":"none",fontStyle:N.font&&N.font.italic?"italic":"none",textDecoration:N.font&&N.font.underline?"underline":"none",textAlign:B,fontFamily:N.font&&N.font.family?N.font.family:"",fontSize:N.font&&N.font.size?N.font.size+"px":"",color:N.font&&N.font.color?N.font.color:"",backgroundColor:N.fill&&N.fill.color?N.fill.color:"",whiteSpace:N.wordWrap?"pre-wrap":"normal",format:E};if(N.borders){if(N.borders.left){this._parseBorderStyle(N.borders.left.style,"Left",s[D]);s[D].borderLeftColor=N.borders.left.color}if(N.borders.right){this._parseBorderStyle(N.borders.right.style,"Right",s[D]);s[D].borderRightColor=N.borders.right.color}if(N.borders.top){this._parseBorderStyle(N.borders.top.style,"Top",s[D]);s[D].borderTopColor=N.borders.top.color}if(N.borders.bottom){this._parseBorderStyle(N.borders.bottom.style,"Bottom",s[D]);s[D].borderBottomColor=N.borders.bottom.color}}if(N.fill&&N.fill.color){var H=s[D],I=N.borders,X=N.fill.color;if(I){I.left&&I.left.color||(H.borderLeftColor=X);I.right&&I.right.color||p===C-1||(H.borderRightColor=X);I.top&&I.top.color||(H.borderTopColor=X);I.bottom&&I.bottom.color||b===_-1||(H.borderBottomColor=X)}else{H.borderLeftColor=X;p!==C-1&&(H.borderRightColor=X);H.borderTopColor=X;b!==_-1&&(H.borderBottomColor=X)}}N.font&&-1===a.indexOf(N.font.family)&&a.push(N.font.family)}A&&e.isNumber(A.rowSpan)&&A.rowSpan>0&&e.isNumber(A.colSpan)&&A.colSpan>0&&(A.rowSpan>1||A.colSpan>1)&&i.push(new e.grid.CellRange(b,p,b+A.rowSpan-1,p+A.colSpan-1))}if(T){this._checkParentCollapsed(u,T.groupLevel)||T.visible||null==T.visible||(l.rows[b-w].visible=T.visible);l.rows[b-w].wordWrap=!!T.style&&!!T.style.wordWrap||!!S}}g&&(g.isCollapsed=y);null!=C&&(l.frozenColumns=C);null!=_&&(l.frozenRows=m&&_>0?_-1:_);for(p=0;p<l.columnHeaders.columns.length;p++){var z=v[p],M=l.columns[p];M.isRequired=!1;if(z){z.dataType===e.DataType.Boolean&&(M.dataType=z.dataType);M.format=z.format;M.align=z.hAlign;M.wordWrap=M.wordWrap||!!z.wordWrap}}for(c=0;c<Math.max(w,1);c++)l.columnHeaders.rows.push(new e.grid.Row);var O=Object.keys(o.rows);for(c=0;c<w;c++)for(var j=0;j<o.columns.length;j++){var L=o.rows[O[c]].cells[j],P=L&&L.value||"",V=l.columnHeaders.columns[j];if(P){var U=e.xlsx.Workbook._parseExcelFormat(L);P=e.Globalize.format(P,U)}V.header=V.header||P;l.columnHeaders.setCellData(c,j,P)}if(n){var q=null==r.sheetVisible||r.sheetVisible;l.wj_sheetInfo.name=o.name;l.wj_sheetInfo.visible=!0===q||!1!==o.visible;l.wj_sheetInfo.styledCells=s;l.wj_sheetInfo.mergedRanges=i;l.wj_sheetInfo.fonts=a;l.wj_sheetInfo.tables=o.tables}}};FlexGridXlsxConverter._getColumnHeadersHeight=function(e){if(!e&&!e.rows.length)return 0;for(var l=1,t=0;t<e.rows.length;t++){var r=e.rows[t];if(r){r.cells.forEach((function(e){l=Math.max(l,e.rowSpan||0)}));break}}return l};FlexGridXlsxConverter._escapePlainText=function(e){return null==e?"":""===e?"'":e&&("'"===e[0]||e.length>1&&"="===e[0]&&"="===e[1])?"'"+e:e};FlexGridXlsxConverter._parseFlexGridRowToSheetRow=function(t,n,s,i,a,u,d,c,f,x,h,p,g){var m,w,y,v,_,C,b,k,S,T,F,R,W,A,G,D,N,E,B,H,I,X,z,M,O,j,L,P,V,U,q=!1,J=!1;(B=(m=t.grid).wj_sheetInfo)&&(H=B.evaluateFormula);if(null==(w=t.rows[s]).recordIndex){M=0;t.cellType===e.grid.CellType.ColumnHeader&&t.rows.length>1&&(M=s===a.length?s-1:s)}else M=w.recordIndex;n.cells||(n.cells=[]);n.visible=w.isVisible;n.height=w.renderHeight||t.rows.defaultSize;n.groupLevel=h;x&&(n.collapsed=w.isCollapsed);w.wordWrap&&(n.style={wordWrap:w.wordWrap});(w.constructor===e.grid.Row||w.constructor===e.grid._NewRowTemplate||l.softTransGrid()&&m instanceof l.softTransGrid().TransposedGrid&&w instanceof e.grid.Row||l.softDetail()&&w.constructor===l.softDetail().DetailRow||l.softMultiRow()&&w.constructor===l.softMultiRow()._MultiRow)&&(q=!0);l.softDetail()&&w.constructor===l.softDetail().DetailRow&&(J=!0);for(v=0;v<t.columns.length;v++){_=null;E=1;N=1;V=0;z=!1;G=null;j=null;k=null;X=m._getBindingColumn(t,s,t.columns[v]);D=null;if(B&&t===m.cells){A=s*t.columns.length+v;B.mergedRanges&&(D=this._getMergedRange(s,v,B.mergedRanges));B.styledCells&&(G=B.styledCells[A])}else if(u!==r.None){j=this._getMeasureCell(t,v,d,c);G=(D=m.getMergedRange(t,s,v,!1))?this._getCellStyle(t,j,D.bottomRow,D.rightCol,f)||{}:this._getCellStyle(t,j,s,v,f)||{}}D||(D=m.getMergedRange(t,s,v,!1));if(D){if(s===D.topRow&&v===D.leftCol){N=D.bottomRow-D.topRow+1;E=this._getColSpan(t,D,p);z=!0}}else z=!0;if(!p||p(X)){y=a[M]?a[M][v+i]:null;if(q||x){b=z?t.getCellData(s,v,!0):null;S=z?t.getCellData(s,v,!1):null;F=this._isFormula(b);W=null;I=e.isDate(S);if(G&&G.format&&null!=S){_=G.format;/[hsmyt\:]/i.test(_)&&(I=!0);C=e.xlsx.Workbook._parseCellFormat(G.format,I)}else if(y&&y.style&&y.style.format){_=X.format;C=y.style.format}else C=null;F&&null!=H&&e.isFunction(H)&&(W=H(b));if(!C)if(I)C="m/d/yyyy";else if(e.isNumber(S)&&!X.dataMap)C=e.isInt(S)?"#,##0":"#,##0.00";else if(F){if((R=b.toLowerCase()).indexOf("now()")>-1){C="m/d/yyyy h:mm";I=!0}else if(R.indexOf("today()")>-1||R.indexOf("date(")>-1){C="m/d/yyyy";I=!0}else if(R.indexOf("time(")>-1){C="h:mm AM/PM";I=!0}}else C="General"}else{b=z?m.columnHeaders.getCellData(0,v,!0):null;C="General"}if(e.isString(b)&&-1!==b.indexOf("<span")){k=this._parseToTextRuns(b);b=null}L=this._parseCellStyle(G)||{};if(t===m.cells&&x&&w.hasChildren&&v===m.columns.firstVisibleIndex){F&&null!=W?T=W:b?T=b:z&&(T=w.getGroupHeader().replace(/<\/?\w+>/g,"").replace(/&#39;/g,"'"));if(null==T&&!G)continue;!(I=e.isDate(T))&&_&&"d"===_.toLowerCase()&&e.isInt(T)&&(C="0");T=e.isString(T)?e.xlsx.Workbook._unescapeXML(T):T;v===m.columns.firstVisibleIndex&&m.treeIndent&&(V=h);O={value:T,isDate:I,formula:F?this._parseToExcelFormula(b,I):null,colSpan:E,rowSpan:N,style:this._extend(L,{format:C,font:{bold:!0},hAlign:e.xlsx.HAlign.Left,indent:V}),textRuns:k}}else{b=e.isString(b)?e.xlsx.Workbook._unescapeXML(b):b;S=e.isString(S)?e.xlsx.Workbook._unescapeXML(S):S;!I&&_&&"d"===_.toLowerCase()&&e.isInt(S)&&(C="0");P=L&&L.hAlign?L.hAlign:y&&y.style&&null!=y.style.hAlign?e.asEnum(y.style.hAlign,e.xlsx.HAlign,!0):e.isDate(S)?e.xlsx.HAlign.Left:e.xlsx.HAlign.General;v!==m.columns.firstVisibleIndex||!m.treeIndent||P!==e.xlsx.HAlign.Left&&P!==e.xlsx.HAlign.General||(V=h);O={value:F?W:"General"!==C||""===b&&null==S?this._escapePlainText(S):this._escapePlainText(b),isDate:I,formula:F?this._parseToExcelFormula(b,I):null,colSpan:v<m.columns.firstVisibleIndex?1:E,rowSpan:N,style:this._extend(L,{format:C,hAlign:P,vAlign:N>1?t===m.cells||!1===m.centerHeadersVertically?e.xlsx.VAlign.Top:e.xlsx.VAlign.Center:null,indent:V}),textRuns:k};J&&(U=t.getCellElement(s,v))&&U.appendChild(w.detail)}g&&g(new o(t,new e.grid.CellRange(s,v),j,d,c,f,O));n.cells.push(O)}}return i+v};FlexGridXlsxConverter._parseCellStyle=function(l,t){void 0===t&&(t=!1);if(null==l)return null;var r=l.fontSize;r=r?+r.substring(0,r.indexOf("px")):null;isNaN(r)&&(r=null);var o=l.fontWeight;o="bold"===o||+o>=700;var n="italic"===l.fontStyle,s=l.textDecorationStyle;null==s&&(s=l.textDecoration);s="underline"===s;var i=l.whiteSpace;i=!!i&&i.indexOf("pre")>-1;return{font:{bold:o,italic:n,underline:s,family:this._parseToExcelFontFamily(l.fontFamily),size:r,color:l.color},fill:{color:l.backgroundColor},borders:this._parseBorder(l,t),hAlign:e.xlsx.Workbook._parseStringToHAlign(l.textAlign),wordWrap:i}};FlexGridXlsxConverter._parseBorder=function(e,l){var t={};t.left=this._parseEgdeBorder(e,"Left");t.right=this._parseEgdeBorder(e,"Right");t.top=this._parseEgdeBorder(e,"Top");t.bottom=this._parseEgdeBorder(e,"Bottom");if(l){t.vertical=this._parseEgdeBorder(e,"Vertical");t.horizontal=this._parseEgdeBorder(e,"Horizontal")}return t};FlexGridXlsxConverter._parseEgdeBorder=function(l,t){var r,o=l["border"+t+"Style"],n=l["border"+t+"Width"];n&&n.length>2&&(n=+n.substring(0,n.length-2));if(o&&"none"!==o&&"hidden"!==o){r={};switch(o=o.toLowerCase()){case"dotted":r.style=n>1?e.xlsx.BorderStyle.MediumDashDotted:e.xlsx.BorderStyle.Dotted;break;case"dashed":r.style=n>1?e.xlsx.BorderStyle.MediumDashed:e.xlsx.BorderStyle.Dashed;break;case"double":r.style=e.xlsx.BorderStyle.Double;break;default:r.style=n>2?e.xlsx.BorderStyle.Thick:n>1?e.xlsx.BorderStyle.Medium:e.xlsx.BorderStyle.Thin}r.color=l["border"+t+"Color"]}return r};FlexGridXlsxConverter._parseBorderStyle=function(l,t,r){var o="border"+t+"Style",n="border"+t+"Width";switch(l){case e.xlsx.BorderStyle.Dotted:case e.xlsx.BorderStyle.Hair:r[o]="dotted";r[n]="1px";break;case e.xlsx.BorderStyle.Dashed:case e.xlsx.BorderStyle.ThinDashDotDotted:case e.xlsx.BorderStyle.ThinDashDotted:r[o]="dashed";r[n]="1px";break;case e.xlsx.BorderStyle.MediumDashed:case e.xlsx.BorderStyle.MediumDashDotDotted:case e.xlsx.BorderStyle.MediumDashDotted:case e.xlsx.BorderStyle.SlantedMediumDashDotted:r[o]="dashed";r[n]="2px";break;case e.xlsx.BorderStyle.Double:r[o]="double";r[n]="3px";break;case e.xlsx.BorderStyle.Medium:r[o]="solid";r[n]="2px";break;case e.xlsx.BorderStyle.Thick:r[o]="solid";r[n]="3px";break;default:r[o]="solid";r[n]="1px"}};FlexGridXlsxConverter._parseToExcelFontFamily=function(e){var l;e&&(l=e.split(","))&&l.length>0&&(e=l[0].replace(/\"|\'/g,""));return e};FlexGridXlsxConverter._parseToExcelFormula=function(l,t){var r,o,n,s,i,a,u,d=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;if(r=l.match(/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi))for(i=0;i<r.length;i++){u=(a=r[i]).substring(0,a.lastIndexOf(")"))+", 1)";l=l.replace(a,u)}r=null;if(r=l.match(/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi))for(i=0;i<r.length;i++)if((o=(a=r[i]).match(d))&&2===o.length){n=o[1];if(!/^d{1,4}?$/.test(n)){s=e.xlsx.Workbook._parseCellFormat(n,t);u=a.replace(n,s);l=l.replace(a,u)}}return l};FlexGridXlsxConverter._parseToTextRuns=function(e){var l,t,r,o=e.split("<span "),n=[];for(l=0;l<o.length;l++){r=-1!==(t=o[l]).indexOf("</span>")?{text:t.substring(t.indexOf(">")+1,t.indexOf("</span>")),font:this._parseToTextRunFont(t.substring(t.indexOf('style="')+7,t.indexOf(';"')))}:{text:t};n.push(r)}return n};FlexGridXlsxConverter._parseToTextRunFont=function(e){var l,t,r,o,n,s,i,a,u,d=e.split(";");if(d.length>0){for(l=0;l<d.length;l++)if(2===(t=d[l].split(":")).length){t[1]=t[1].trim();switch(t[0]){case"font-size":s=+t[1].substring(0,t[1].indexOf("px"));isNaN(s)&&(s=null);break;case"font-weight":r="bold"===t[1]||+t[1]>=700;break;case"font-style":o="italic"===t[1];break;case"text-decoration-style":case"text-decoration":n="underline"===t[1];break;case"font-family":i=this._parseToExcelFontFamily(t[1]);break;case"color":a=t[1]}}u={bold:r,italic:o,underline:n,family:i,size:s,color:a}}return u};FlexGridXlsxConverter._getMeasureCell=function(e,l,t,r){var o=r[e.cellType],n=o&&o[l],s=null==n;if(n){if(this.hasCssText){n.style;n.style.cssText="";n.style.visibility="hidden"}}else{o||(r[e.cellType]=o=[]);o[l]=n=t.cloneNode()}!s&&n.parentElement||(e.hostElement.children.length>0?e.hostElement.children[0].appendChild(n):e.hostElement.appendChild(n));return n};FlexGridXlsxConverter._getColumnSetting=function(l,t,r){var o=l;null!=l.colspan&&(o=this._getRenderColumn(t,r));return o?{autoWidth:!0,width:o.renderWidth||r.defaultSize,visible:o.visible,style:{format:o.format?e.xlsx.Workbook._parseCellFormat(o.format,o.dataType===e.DataType.Date):"",hAlign:e.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(o.getAlignment())),wordWrap:o.wordWrap}}:null};FlexGridXlsxConverter._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e};FlexGridXlsxConverter._getColumnCount=function(l){for(var t,r=0,o=0,n=0;n<l.length;n++)if((t=l[n]&&l[n].cells?l[n].cells:[])&&t.length>0){o=t.length;e.isInt(t[o-1].colSpan)&&t[o-1].colSpan>1&&(o=o+t[o-1].colSpan-1);o>r&&(r=o)}return r};FlexGridXlsxConverter._getRowCount=function(l,t){for(var r,o,n=l.length,s=n-1,i=0;i<t;i++)e:for(;s>=0;s--)if((o=((r=l[s])&&r.cells?r.cells:[])[i])&&(null!=o.value&&""!==o.value||e.isInt(o.rowSpan)&&o.rowSpan>1)){e.isInt(o.rowSpan)&&o.rowSpan>1&&s+o.rowSpan>n&&(n=s+o.rowSpan);break e}return n};FlexGridXlsxConverter._numAlpha=function(e){var l=Math.floor(e/26)-1;return(l>-1?this._numAlpha(l):"")+String.fromCharCode(65+e%26)};FlexGridXlsxConverter._getItemType=function(l){return null==l||null==l.value||isNaN(l.value)?null:e.getType(l.value)};FlexGridXlsxConverter._setColumn=function(l,t,r){var o,n,s,i=l[t];if(i){o=this._getItemType(r);i.dataType!==o&&i.dataType===e.DataType.Boolean&&o!==e.DataType.Boolean&&(i.dataType=o);!r||null==r.value||e.isString(r.value)&&e.isNullOrWhiteSpace(r.value)||(n=e.xlsx.Workbook._parseExcelFormat(r))&&i.format!==n&&"General"!==n&&(i.format=n);if(r&&r.style){r.style.hAlign&&(s=e.xlsx.Workbook._parseHAlignToString(e.asEnum(r.style.hAlign,e.xlsx.HAlign)));null==i.wordWrap?i.wordWrap=!!r.style.wordWrap:i.wordWrap=i.wordWrap&&!!r.style.wordWrap}s||o!==e.DataType.Number||(s="right");i.hAlign=s}else l[t]={dataType:this._getItemType(r),format:e.xlsx.Workbook._parseExcelFormat(r),hAlign:"",wordWrap:null}};FlexGridXlsxConverter._getItemValue=function(l){if(null==l||null==l.value)return null;var t=l.value;e.isString(t)&&"'"===t[0]&&(t=t.substr(1));return e.isNumber(t)&&isNaN(t)?"":t instanceof Date&&isNaN(t.getTime())?"":t};FlexGridXlsxConverter._getCellStyle=function(e,l,t,r,o){var n;try{e.grid.cellFactory.updateCell(e,t,r,l,null,!o&&void 0);l.className=l.className.replace("wj-state-selected","");l.className=l.className.replace("wj-state-multi-selected","")}catch(e){return null}if(o){var s,i=e.hostElement,a=l;s=a.style.cssText.split(/;\s+/).filter((function(e){var l=e.substring(0,e.indexOf(":"));return/^(color|background|border|font|text|whitespace)/i.test(l)})).join(";");do{s=a.className+s}while(a!==i&&(a=a.parentElement));if(!(n=o.getValue(s))){n=window.getComputedStyle(l);o.add(s,n)}}else n=window.getComputedStyle(l);return n};FlexGridXlsxConverter._parseTextRunsToHTML=function(e){var l,t,r,o;r="";for(o=0;o<e.length;o++)r+=(t=(l=e[o]).font)?'<span style="'+(t.bold?"font-weight: bold;":"")+(t.italic?"font-style: italic;":"")+(t.underline?"text-decoration: underline;":"")+(t.family?"font-family: "+t.family+";":"")+(null!=t.size?"font-size: "+t.size+"px;":"")+(t.color?"color: "+t.color+";":"")+'">'+l.text+"</span>":l.text;return r};FlexGridXlsxConverter._extend=function(l,t){for(var r in t){var o=t[r];e.isObject(o)&&l[r]?e.copy(l[r],o):l[r]=o}return l};FlexGridXlsxConverter._checkParentCollapsed=function(e,l){var t=!1;Object.keys(e).forEach((function(r){!0===e[r]&&!1===t&&!isNaN(l)&&+r<l&&(t=!0)}));return t};FlexGridXlsxConverter._getColSpan=function(e,l,t){for(var r=0,o=l.leftCol;o<=l.rightCol;o++)t&&!t(e.columns[o])||r++;return r};FlexGridXlsxConverter._getRenderColumn=function(e,l){return e>=l.length?null:l[e]};FlexGridXlsxConverter._getMergedRange=function(e,l,t){var r,o;for(r=0;r<t.length;r++)if(e>=(o=t[r]).topRow&&e<=o.bottomRow&&l>=o.leftCol&&l<=o.rightCol)return o;return null};FlexGridXlsxConverter._isFormula=function(e){return e&&"string"==typeof e&&e.length>1&&"="===e[0]&&"="!==e[1]};return FlexGridXlsxConverter}();l.FlexGridXlsxConverter=t;var r,o=function(e){__extends(XlsxFormatItemEventArgs,e);function XlsxFormatItemEventArgs(l,t,r,o,n,s,i){var a=e.call(this,l,t)||this;a._cell=r;a._patternCell=o;a._xlsxCell=i;a._cellsCache=n;a._styleCache=s;return a}Object.defineProperty(XlsxFormatItemEventArgs.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});Object.defineProperty(XlsxFormatItemEventArgs.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0});XlsxFormatItemEventArgs.prototype.getFormattedCell=function(){if(!this._cell){this._cell=t._getMeasureCell(this.panel,this.col,this._patternCell,this._cellsCache);t._getCellStyle(this.panel,this._cell,this.row,this.col,this._styleCache)}return this._cell};return XlsxFormatItemEventArgs}(e.grid.CellRangeEventArgs);l.XlsxFormatItemEventArgs=o;!function(e){e[e.None=0]="None";e[e.Regular=1]="Regular";e[e.Cache=2]="Cache"}(r||(r={}));var n=function(){function _StyleCache(e){this._cache={};this._size=0;this._max=e}_StyleCache.prototype.add=function(e,l){this._size>=this._max&&this.clear();this._cache[e]=this._cloneStyle(l);this._size++};_StyleCache.prototype.clear=function(){this._cache={};this._size=0};_StyleCache.prototype.getValue=function(e){return this._cache[e]||null};_StyleCache.prototype.hasKey=function(e){return!!this._cache[e]};_StyleCache.prototype._cloneStyle=function(e){if(!e)return null;for(var l={},toCamel=function(e){return e.replace(/\-([a-z])/g,(function(e,l,t){return t>0?l.toUpperCase():l}))},t=0,r=e.length;t<r;t++){var o=e[t];l[toCamel(o)]=e.getPropertyValue(o)}return l};return _StyleCache}();l._StyleCache=n})((l=e.grid||(e.grid={})).xlsx||(l.xlsx={}))}(wijmo||(wijmo={}));!function(e){!function(l){l.xlsx||(l.xlsx={}),e._registerModule("wijmo.grid.xlsx",e.grid.xlsx)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));